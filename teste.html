<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Teste de Nivelamento</title>
  <link rel="stylesheet" href="estilo.css">
  <link rel="icon" type="image/x-icon" href="https://app.trimmy.io/storage/trimmy/original-images/tRceiV3LGx3vmq/1756149814-united-kingdom.png">
</head>
<body>
  <header class="cabecalho1">
    <ul class="voltar">
      <li><a href="pag-teste.html">Voltar</a></li>
    </ul>
  </header>
  <h2>Teste de Nivelamento</h2>
  <div id="quiz-container"></div>
  <button id="next-button" class="hidden">Próxima</button>
  <div id="result" class="hidden"></div>

  <script>
    const bloco1 = [
      {
        question: "What color is the sky on a clear dat?", 
        options: [
          "Red", 
          "Green", 
          "Yellow", 
          "Blue"],
        answer: 3
      },
      {
        question: "How do you form the negative of the sentence: 'She likes apples'?", 
        options: [
          "She doesn't like apples",
          "She don't like apples",
          "She not like apples",
          "She does like apples"
        ],
        answer: 0
      },
      {
        question: "Choose the correct sentence in past tense:", 
        options: [
          "He go to school yesterday.", 
          "He went to school yesterday.", 
          "He gone to school yesterday.", 
          "He goes to school yesterday."],
        answer: 1
      },
      {
        question: "Choose the correct option to complete: 'I have lived here ___ five years.'", 
        options: ["during", "since", "for", "from"],
        answer: 2
      }
    ];

    const bloco2 = [
      {
        question: "What color are the swirls?:", 
        options: [
          "Red, blue and yellow.",
          "Red, black and yellow.",
          "Pink, grey and blue.",
          "Green, orange and red."
        ],
        answer: 0,
        audio: "https://essential.com.br/wp-content/uploads/2023/10/audio-5-1.ogg?_=5"
      },
      {
        question: "What is Sara's daughter name?:", 
        options: [
          "Amy",
          "Emma",
          "Sofia",
          "Mia"
        ],
        answer: 3,
        audio: "https://essential.com.br/wp-content/uploads/2023/10/audio-3-1.ogg?_=3"
      },
      {
        question: "Qual é o sentimento descrito no aúdio?", 
        options: [
          "Medo",
          "Luto",
          "Raiva",
          "Desgosto"
        ],
        answer: 1,
        audio: "https://essential.com.br/wp-content/uploads/2024/02/Grief.mp3?_=2"
      },
      {
        question: "Com quem Emily vai passar um tempo?", 
        options: [
          "Com os tios",
          "Com a mãe",
          "Com os amigos",
          "Com os avós"
        ],
        answer: 0,
        audio: "https://essential.com.br/wp-content/uploads/2024/02/back-to-the-start.mp3?_=10"
      }
    ];

    let currentBlock = bloco1;
    let blockIndex = 0;
    let block1Score = 0;
    let block2Score = 0;
    let currentQuestionIndex = 0;

    const container = document.getElementById('quiz-container');
    const nextButton = document.getElementById('next-button');
    const resultDiv = document.getElementById('result');

    function renderQuestion() {
      if (currentQuestionIndex >= currentBlock.length) {
        nextButton.style.display = 'none';
        showResult();
        return;
      }

      const questionData = currentBlock[currentQuestionIndex];
      container.innerHTML = '';
      container.style.display = 'block';

      const block = document.createElement('div');
      block.className = 'question-block';

      const q = document.createElement('p');
      q.textContent = questionData.question;
      block.appendChild(q);

      if (questionData.audio) {
        const audio = document.createElement('audio');
        audio.controls = true;
        audio.src = questionData.audio;
        block.appendChild(audio);
      }

      questionData.options.forEach((option, i) => {
        const label = document.createElement('label');
        label.style.display = 'block';

        const input = document.createElement('input');
        input.type = 'radio';
        input.name = 'option';
        input.value = i;

        label.appendChild(input);
        label.appendChild(document.createTextNode(option));
        block.appendChild(label);
      });

      container.appendChild(block);
      nextButton.style.display = (currentQuestionIndex < currentBlock.length) ? 'block' : 'none';
    }

    function handleNext() {
      const selected = document.querySelector('input[name="option"]:checked');
      if (!selected) {
        alert("Selecione uma resposta.");
        return;
      }

      const answer = parseInt(selected.value);
      if (currentBlock[currentQuestionIndex].answer === answer) {
        if (blockIndex === 0) block1Score++;
        else block2Score++;
      }

      currentQuestionIndex++;

      if (blockIndex === 0 && currentQuestionIndex === 2 && block1Score === 0) {
        blockIndex = 1;
        currentBlock = bloco2;
        currentQuestionIndex = 0;
        renderQuestion();
        return;
      }

      if (blockIndex === 1 && currentQuestionIndex === 2 && block2Score === 0) {
        nextButton.style.display = 'none';
        showResult();
        return;
      }

      if (currentQuestionIndex < currentBlock.length) {
        renderQuestion();
      } else {
        if (blockIndex === 0) {
          blockIndex = 1;
          currentBlock = bloco2;
          currentQuestionIndex = 0;
          renderQuestion();
        } else {
          nextButton.style.display = 'none';
          showResult();
        }
      }
    }

    function showResult() {
      container.innerHTML = '';
      container.style.display = 'none';
      nextButton.style.display = 'none';
      resultDiv.classList.remove('hidden');

      let nivel = 'Básico';
      if ((block1Score + block2Score) >= 4) {
        nivel = 'Intermediário';
      }

      resultDiv.innerHTML = `<h3>Seu nível é: ${nivel}</h3>`;
    }

    nextButton.addEventListener('click', handleNext);
    renderQuestion();
  </script>
</body>
</html>
